# Week 2 任务分配

**日期**: 2026-02-02
**目标**: 从 0D 扩展到 **1D PDE**，用 Bang-Bang 控制研究恒温器放置位置问题
**产出格式**: `.ipynb` notebook + 图片存入 `Result/` + `report.md`

---

## 回顾 Week 1 成果

- 0D Bang-Bang 解析解（加热/冷却曲线）
- 半带/全带切换时间推导
- Zeno 效应分析
- 能耗与最优 δ 分析
- 完整瞬态仿真

---

## Week 2 核心问题

> **从"一个点的温度"到"一条线上的温度分布"——恒温器放在哪里最合理？**

Week 1 假设整个房间温度均匀 (0D)，但现实中加热器在一端、房间另一端温度会更低。
1D 模型让我们第一次能讨论**空间位置**的影响。

---

## 三组任务

### 组 A — 1D 模型建立与数值方法（2人）

**关键词**: 数学推导 + 代码实现

**任务**:

1. **1D 热方程推导**
   - 从热传导基本定律出发，写出 1D 热方程:
     ```
     ∂T/∂t = α · ∂²T/∂x² + S(x, t)
     ```
   - 明确物理参数的含义和取值（α 热扩散率、房间长度 L 等）
   - 说明与 0D 模型的关系: 当空间均匀时，1D 退化为 0D

2. **边界条件**
   - Robin 边界条件（对流散热）: `-κ · ∂T/∂n = h · (T - T_a)`
   - 讨论不同边界条件的物理含义（绝热墙 vs 外墙）
   - 建议: 左边界 x=0 绝热（内墙），右边界 x=L Robin BC（外墙）

3. **热源建模**
   - 加热器作为空间分布热源 S(x, t)
   - 集中热源（如 x=0 附近的高斯分布）vs 均匀热源
   - 热源强度与 0D 中 U_max 的对应关系

4. **有限差分离散**
   - 空间离散: N 个网格点，中心差分格式
   - 边界条件的离散处理（ghost point 方法）
   - Method of Lines: 得到 ODE 系统 `dT_vec/dt = A·T_vec + b(t)`
   - 用 `scipy.solve_ivp` 求解

5. **验证**
   - 与解析解对比（如无热源、简单初始条件的情况）
   - 网格收敛性测试（N=20, 50, 100）

**产出**:
- 模型代码（可参考 `Code/models/pde_1d_model.py`）
- 验证图: 数值解 vs 解析解、网格收敛性
- `report_model.md`: 完整数学推导 + 离散格式 + 验证结果

---

### 组 B — 恒温器位置实验（2人）

**关键词**: 仿真实验 + 数据分析

**任务**:

1. **实验设计**
   - 加热器固定位置（x=0，房间左端）
   - 恒温器测量位置扫描: x_sensor = 0, L/4, L/2, 3L/4, L（5个位置）
   - 控制策略: Bang-Bang（与 Week 1 一致，δ = 0.5°C）
   - 控制逻辑: 恒温器读数 T(x_sensor, t) 决定开关

2. **每个位置运行仿真，记录**:
   - 恒温器处温度 T(x_sensor, t) 随时间变化
   - 房间平均温度 T_avg(t) 随时间变化
   - 房间最冷点温度 T_min(t)
   - 控制输入 u(t)（开/关状态）
   - 温度场快照（t = 10, 30, 60, 120 min 时刻的 T(x) 分布）

3. **定量指标对比**（每个位置都算）:
   | 指标 | 说明 |
   |------|------|
   | 能耗 E | ∫u(t)dt |
   | RMSE (传感器处) | 恒温器读数相对 T_set 的偏差 |
   | RMSE (全房间) | 房间平均温度相对 T_set 的偏差 |
   | 最大温差 | max(T) - min(T) 在稳态时 |
   | 切换次数 | 120 min 内开关次数 |
   | 稳定时间 | 平均温度首次进入 T_set ± 0.5°C |

4. **额外实验**（如有余力）:
   - 加热器位置也变化（x=0, L/2, L）看影响
   - δ = 0.5, 1.0, 2.0 与位置的交叉对比

**产出**:
- `Week2_1D_BangBang_Placement.ipynb`
- 5个位置的对比数据表
- `report_experiment.md`: 实验设置 + 结果 + 初步分析

---

### 组 C — 可视化与结果分析（2人）

**关键词**: 图表制作 + 物理解释 + 报告撰写

**任务**:

1. **核心可视化**（基于组 B 的数据）:
   - **温度场热力图** (heatmap): x 轴=空间位置, y 轴=时间, 颜色=温度
     - 每个恒温器位置画一张，共 5 张
   - **位置对比图**: 同一时刻不同位置的温度分布 T(x) 叠加
   - **指标汇总柱状图**: 5个位置的能耗、RMSE、切换次数对比
   - **最优位置图**: X轴=恒温器位置, Y轴=综合代价 J

2. **物理解释与讨论**:
   - 为什么恒温器放在加热器旁边（x=0）效果差？（快速响应但远端过冷）
   - 为什么恒温器放在远端（x=L）效果也不理想？（响应慢、过热）
   - 最优位置的物理直觉是什么？
   - 1D 结果与 0D 的对比: 空间效应带来了什么新发现？

3. **报告整合**:
   - 将三组内容整合为一份完整的 Week 2 report
   - 结构: 模型介绍 → 数值方法 → 实验设计 → 结果 → 讨论
   - 确保所有公式、变量名与 Week 1 和 Handnote 一致

**产出**:
- 所有图表（存入 `Result/`）
- `Week2_Report.md`: Week 2 完整报告

---

## 统一参数

| 参数 | 值 | 说明 |
|------|-----|------|
| T_a | 5.0 °C | 室外温度 |
| T_set | 20.0 °C | 设定温度 |
| k | 0.1 1/min | 冷却常数 (0D) |
| U_max | 15.0 °C/min | 最大加热速率 |
| δ | 0.5 °C | Bang-Bang 滞回带宽 |
| L | 5.0 m | 房间长度 (1D) |
| α | 待组A确定 | 热扩散率 |
| N | 50 | 空间网格点数 |
| 仿真时间 | 120 min | |

**变量命名**: T(t), T_a, T_set, T_h, T_l, k, u(t) — 与 Handnote 一致

---

## 协作流程

```
组 A (模型+代码) ──→ 组 B (跑实验) ──→ 组 C (可视化+报告)
     ↑                    ↑                    ↑
   先完成模型代码      基于A的代码跑实验     基于B的数据出图+写报告
```

- 组 A 先行，尽快完成模型代码供 B 使用
- 组 B 拿到代码后跑实验、整理数据
- 组 C 全程可以先准备报告框架，拿到数据后填充图表和讨论
- **三组保持沟通**，不要各做各的

---

## 代码参考

已有代码可直接参考（注意变量名统一）:
- `Code/models/pde_1d_model.py` — 1D PDE 模型
- `Code/controllers/bang_bang.py` — Bang-Bang 控制器
- `Code/experiments/exp_1d_placement.py` — 1D 位置实验脚本
- `Code/utils/parameters.py` — 统一参数
- `Code/utils/metrics.py` — 评价指标

---

## 时间线

| 事项 | 截止 |
|------|------|
| 组 A 完成模型代码 + 验证 | Week 2 中期 |
| 组 B 完成全部实验 | Week 2 后期 |
| 组 C 完成报告 | Week 2 结束 |
| 最终报告提交 | 2026-03-09 |
| 答辩 | 2026-03-16 |
